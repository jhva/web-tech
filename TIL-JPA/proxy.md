
# JPA의 프록시

- 지연로딩을 기능을 사용하려면 실제 엔티티 객체 대신에 데이터베이스 조회를 지연할 수 있는 가짜 객체가 필요한데 이것을 프록시 객체라함. 

### 프록시 기초 
```
User user = em.find(User.class,"user1")

User user = em.getReference(User.class,"user1")
```
- 엔티티를 하나를 조회할땐 find를 쓰는데 영속성컨텍스트에 없으면 데이터베이스를 조회함
- 엔티티를 실제사용하는 시점까지 데이터베이스 조회를 미루고싶으면 em.getReference를 쓰면된다. 
  - 이메서드룰 사용하면 데이터베이스에 조회하지않고 실제엔티티 객체도 생성하지않는다.하지만
  데이터 베이스 접근을 위임한 프록시 객체를 반환해줌


### 프록시 특징 
> 프록시 클래스는 실제 클래스를 상속 받아서 만들어져서 겉모습이랑 똑같음 
- 프록시 객체는 실제 객체에 대한 참조(target)을 보관함. 그리고 프록시 객체의 메소드를 호출하면 프록시 객체는 실제 객체의 메소드를 호출함 

### 프록시 객체의 초기화 
>프록시 객체는 데이터베이스를 조회해서 실제 엔티티 객체를 생성하는데 이걸 프록시객체의 초기화라한다


### 즉시로딩 과 지연 로딩 
- 즉시로딩 
  - 엔티티를 조회할 대 연관된 엔티티 도 함게 조회함 
```
Member member=em.find

Team team = memeber.getTeam()// 객체 그래프탐색 
```
  - 즉시 로딩을 최적화하기 위해서 가능하면 조인 쿼리를 사용해야함 
- 지연로딩
  - 연관된  엔티티를 실제 사용할때 조회함
  - 실제 사용될  때까지 데이터로딩을 미룬다 
    - 실제 데이터가 필요한 순간이 되어서야 데이터베이스를 조회해서 객체를 조기홯마
```

Member member=em.find

Team team = memeber.getTeam()// 객체 그래프탐색 

team.getName();
```

